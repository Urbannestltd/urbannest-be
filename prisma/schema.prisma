generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model user {
  userId          String   @id @default(uuid())
  userFirstName   String?
  userFullName    String?
  userPhone       String?
  userEmail       String   @unique
  userPassword    String?
  userGoogleId    String?  @unique
  userRole        role     @relation(fields: [userRoleId], references: [roleId])
  userRoleId      String
  userStatus      String   @default("PENDING")
  userCreatedAt   DateTime @default(now())
  userUpdatedAt   DateTime @updatedAt

  otpLogs otpLogs[]
  passwordResetTokens passwordReset[]
  registrationLinks userRegistrationLink[]
}

model role {
  roleId          String   @id @default(uuid())
  roleName        String   @unique
  roleDescription String?
  roleStatus      String   @default("ACTIVE")
  roleCreatedAt   DateTime @default(now())
  roleUpdatedAt   DateTime @updatedAt

  users user[]
}

model privilege {
  privilegeId          String   @id @default(uuid())
  privilegeName        String   @unique
  privilegeDescription String?
  privilegeStatus      String   @default("ACTIVE")
  privilegeCreatedAt   DateTime @default(now())
  privilegeUpdatedAt   DateTime @updatedAt
}

model otpLogs {
  otpLogId        String   @id @default(uuid())
  otpLogHash      String
  otpLogUserId    String
  otpLogUser      user     @relation(fields: [otpLogUserId], references: [userId])
  otpLogStatus    String   @default("ACTIVE")
  otpLogExpiry    DateTime
  otpLogCreatedAt DateTime @default(now())
  otpLogUpdatedAt DateTime @updatedAt
}

model userRegistrationLink {
  userRegistrationLinkId        String   @id @default(uuid())
  userRegistrationLinkToken     String   @unique
  userRegistrationLinkExpiresAt DateTime

  userRegistrationLinkUserId    String
  userRegistrationLinkUser      user     @relation(fields: [userRegistrationLinkUserId], references: [userId], onDelete: Cascade)

  userRegistrationLinkUsed      Boolean  @default(false)
  userRegistrationLinkIpAddress String?

  userRegistrationLinkCreatedAt DateTime @default(now())
  userRegistrationLinkUpdatedAt DateTime @updatedAt
}

model passwordReset {
  passwordResetId        String   @id @default(uuid())
  passwordResetToken     String   @unique
  passwordResetExpiresAt DateTime
  
  
  passwordResetUserId    String
  passwordResetUser      user     @relation(fields: [passwordResetUserId], references: [userId], onDelete: Cascade)

  passwordResetUsed      Boolean  @default(false) 
  passwordResetIpAddress String?
  
  passwordResetCreatedAt DateTime @default(now())
  passwordResetUpdatedAt DateTime @updatedAt
}

